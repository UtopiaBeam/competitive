#include<cstdio>
int q,n,h,a[30][4],b[4];
int main(){
    scanf("%d",&q);
    while(q--){
        b[0]=b[1]=b[2]=0,b[3]=1;
        scanf("%d %d %d %d %d",&a[0][1],&a[0][2],&a[0][3],&n,&h);
        for(int i=1;i<30;i++){
            a[i][0]=(2*(a[i-1][1]*a[i-1][2]+a[i-1][0]*a[i-1][3]))%h;
            a[i][1]=(2*(2*a[i-1][2]*a[i-1][0]+a[i-1][1]*a[i-1][3]))%h;
            a[i][2]=(2*(3*a[i-1][1]*a[i-1][0]+a[i-1][2]*a[i-1][3]))%h;
            a[i][3]=(6*a[i-1][0]*a[i-1][0]+3*a[i-1][1]*a[i-1][1]+2*a[i-1][2]*a[i-1][2]+a[i-1][3]*a[i-1][3])%h;
        }
        for(int i=0;(1<<i)<=n;i++)
            if((n>>i)%2){
                int t1,t2,t3,t4;
                t1=(6*a[i][0]*b[0]+3*a[i][1]*b[1]+2*a[i][2]*b[2]+a[i][3]*b[3])%h;
                t2=(3*a[i][0]*b[1]+3*a[i][1]*b[0]+a[i][2]*b[3]+a[i][3]*b[2])%h;
                t3=(2*a[i][0]*b[2]+a[i][1]*b[3]+2*a[i][2]*b[0]+a[i][3]*b[1])%h;
                t4=(a[i][0]*b[3]+a[i][1]*b[2]+a[i][2]*b[1]+a[i][3]*b[0])%h;
                b[3]=t1,b[2]=t2,b[1]=t3,b[0]=t4;
            }
        for(int i=0;i<4;i++)
            printf("%d ",b[i]);
        printf("\n");
    }
    return 0;
}
